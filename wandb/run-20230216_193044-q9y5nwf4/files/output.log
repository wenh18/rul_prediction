
(79923, 100, 13) (79923, 3) (220, 100, 13) (220, 3)
training epoch: 0
step: 0 train loss: 0.028811784 0.028811784
step: 50 train loss: 0.038971577 0.03164363
step: 100 train loss: 0.02293966 0.028466124
step: 150 train loss: 0.015603841 0.026330013
step: 200 train loss: 0.024210304 0.025457174
step: 250 train loss: 0.026188957 0.024934301
step: 300 train loss: 0.0150723215 0.024260588
step: 350 train loss: 0.01962187 0.023826689
step: 400 train loss: 0.031162271 0.023493493
step: 450 train loss: 0.029804772 0.02331266
step: 500 train loss: 0.023828255 0.023131857
step: 550 train loss: 0.025379354 0.022991931
step: 600 train loss: 0.021595506 0.022762254
step: 650 train loss: 0.023698395 0.022677163
step: 700 train loss: 0.017632732 0.022530684
step: 750 train loss: 0.019917265 0.022382135
step: 800 train loss: 0.026631417 0.022240017
step: 850 train loss: 0.00875966 0.022100147
step: 900 train loss: 0.018427694 0.022036655
step: 950 train loss: 0.021269029 0.021855721
step: 1000 train loss: 0.024096375 0.021766838
step: 1050 train loss: 0.019060187 0.021695916
step: 1100 train loss: 0.020816188 0.02161746
step: 1150 train loss: 0.019604316 0.021508288
step: 1200 train loss: 0.011284539 0.021456102
step: 1250 train loss: 0.022600705 0.021371325
step: 1300 train loss: 0.023891212 0.021316374
step: 1350 train loss: 0.013565639 0.021249225
step: 1400 train loss: 0.017297678 0.021158986
step: 1450 train loss: 0.019551244 0.021085193
step: 1500 train loss: 0.0186866 0.021019716
step: 1550 train loss: 0.013018669 0.02096946
step: 1600 train loss: 0.024650518 0.020913947
step: 1650 train loss: 0.023048634 0.020857593
step: 1700 train loss: 0.014444591 0.020824179
step: 1750 train loss: 0.013372248 0.02078128
step: 1800 train loss: 0.023016201 0.020723253
step: 1850 train loss: 0.01901684 0.02065744
step: 1900 train loss: 0.016289698 0.020630244
step: 1950 train loss: 0.029213732 0.02059271
step: 2000 train loss: 0.024523694 0.02050736
step: 2050 train loss: 0.016580794 0.020462962
step: 2100 train loss: 0.011903967 0.020425085
step: 2150 train loss: 0.016214756 0.020380957
step: 2200 train loss: 0.02734437 0.020358477
step: 2250 train loss: 0.01629996 0.02032465
step: 2300 train loss: 0.016481783 0.020291463
step: 2350 train loss: 0.017031047 0.02027074
step: 2400 train loss: 0.017367037 0.020230534
step: 2450 train loss: 0.022495389 0.020180995
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.5911]], device='cuda:0') tensor(0.5447)
tensor([[0.5790]], device='cuda:0') tensor(0.8603)
tensor([[0.5573]], device='cuda:0') tensor(0.5890)
error: tensor(0.1523)
tensor(292.5409)
Epoch number :  0
-- "train" loss 0.03101 -- "valid" loss 292.5
training epoch: 1
step: 0 train loss: 0.013212824 0.020142004
step: 50 train loss: 0.014936243 0.020123636
step: 100 train loss: 0.016466122 0.02011632
step: 150 train loss: 0.01988214 0.0200708
step: 200 train loss: 0.0118831 0.020025913
step: 250 train loss: 0.016432242 0.019988634
step: 300 train loss: 0.019988129 0.019949656
step: 350 train loss: 0.021404482 0.019923335
step: 400 train loss: 0.021123104 0.019897854
step: 450 train loss: 0.019026998 0.019890714
step: 500 train loss: 0.025263654 0.019870162
step: 550 train loss: 0.019014673 0.019834755
step: 600 train loss: 0.01291721 0.01981295
step: 650 train loss: 0.022495847 0.019806456
step: 700 train loss: 0.01714487 0.019780817
step: 750 train loss: 0.01771405 0.019770892
step: 800 train loss: 0.016297407 0.019737883
step: 850 train loss: 0.019132562 0.019735742
step: 900 train loss: 0.029138474 0.019722827
step: 950 train loss: 0.020436604 0.01970825
step: 1000 train loss: 0.022735788 0.019674338
step: 1050 train loss: 0.015956527 0.019652275
step: 1100 train loss: 0.009481078 0.01963846
step: 1150 train loss: 0.035040468 0.019631654
step: 1200 train loss: 0.026558243 0.019632522
step: 1250 train loss: 0.012608335 0.019617205
step: 1300 train loss: 0.01861313 0.019589389
step: 1350 train loss: 0.02223759 0.019569574
step: 1400 train loss: 0.0069759 0.019541366
step: 1450 train loss: 0.018757494 0.019519508
step: 1500 train loss: 0.015449461 0.019508516
step: 1550 train loss: 0.019141423 0.01949362
step: 1600 train loss: 0.009691941 0.019481534
step: 1650 train loss: 0.014419309 0.019473294
step: 1700 train loss: 0.025682865 0.019458815
step: 1750 train loss: 0.019233339 0.019433465
step: 1800 train loss: 0.017375378 0.019406145
step: 1850 train loss: 0.017756445 0.01938063
step: 1900 train loss: 0.020497505 0.01937489
step: 1950 train loss: 0.018142683 0.019354552
step: 2000 train loss: 0.010759156 0.019339906
step: 2050 train loss: 0.013623321 0.019326426
step: 2100 train loss: 0.016928315 0.01931191
step: 2150 train loss: 0.011447167 0.01930422
step: 2200 train loss: 0.013408486 0.019291254
step: 2250 train loss: 0.0235022 0.019277764
step: 2300 train loss: 0.021783696 0.019255314
step: 2350 train loss: 0.013273384 0.01923592
step: 2400 train loss: 0.009680867 0.01922876
step: 2450 train loss: 0.021078048 0.01920903
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6180]], device='cuda:0') tensor(0.5447)
tensor([[0.5932]], device='cuda:0') tensor(0.8603)
tensor([[0.5465]], device='cuda:0') tensor(0.5890)
error: tensor(0.1530)
tensor(294.1504)
Epoch number :  1
-- "train" loss 0.02481 -- "valid" loss 294.2
training epoch: 2
step: 0 train loss: 0.02755792 0.019204196
step: 50 train loss: 0.011230335 0.01918431
step: 100 train loss: 0.016914902 0.019171117
step: 150 train loss: 0.021750346 0.019170335
step: 200 train loss: 0.01836083 0.019164532
step: 250 train loss: 0.018261552 0.019151142
step: 300 train loss: 0.016922964 0.019134868
step: 350 train loss: 0.01648868 0.019123608
step: 400 train loss: 0.021636691 0.019111563
step: 450 train loss: 0.019357525 0.01909769
step: 500 train loss: 0.022652622 0.019092962
step: 550 train loss: 0.015992265 0.019078285
step: 600 train loss: 0.031072708 0.019061655
step: 650 train loss: 0.017907323 0.019049617
step: 700 train loss: 0.024053738 0.01904057
step: 750 train loss: 0.01976638 0.019042684
step: 800 train loss: 0.024968034 0.019033045
step: 850 train loss: 0.018629346 0.019026205
step: 900 train loss: 0.017962389 0.019014705
step: 950 train loss: 0.020152908 0.01901131
step: 1000 train loss: 0.02200111 0.01900666
step: 1050 train loss: 0.016713256 0.019000541
step: 1100 train loss: 0.024403173 0.01899025
step: 1150 train loss: 0.029115021 0.018982697
step: 1200 train loss: 0.01776231 0.018968524
step: 1250 train loss: 0.018568048 0.01896049
step: 1300 train loss: 0.026184246 0.018956263
step: 1350 train loss: 0.0165556 0.018951299
step: 1400 train loss: 0.010013028 0.018941758
step: 1450 train loss: 0.013350521 0.018929312
step: 1500 train loss: 0.016246166 0.018919125
step: 1550 train loss: 0.0147667 0.018913725
step: 1600 train loss: 0.017509352 0.018904729
step: 1650 train loss: 0.013835526 0.018904187
step: 1700 train loss: 0.019253638 0.01889844
step: 1750 train loss: 0.025138965 0.0188849
step: 1800 train loss: 0.01837625 0.018873248
step: 1850 train loss: 0.015068531 0.018867007
step: 1900 train loss: 0.01674514 0.018861277
step: 1950 train loss: 0.010768954 0.018852027
step: 2000 train loss: 0.013676185 0.018836902
step: 2050 train loss: 0.0174061 0.018823175
step: 2100 train loss: 0.019942697 0.018812833
step: 2150 train loss: 0.01677141 0.01881063
step: 2200 train loss: 0.013922081 0.018804684
step: 2250 train loss: 0.017164908 0.018802172
step: 2300 train loss: 0.0153321335 0.018799895
step: 2350 train loss: 0.010820906 0.01878628
step: 2400 train loss: 0.022331584 0.01878247

step: 2450 train loss: 0.014134752 0.018770015
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6498]], device='cuda:0') tensor(0.5447)
tensor([[0.6157]], device='cuda:0') tensor(0.8603)
tensor([[0.6228]], device='cuda:0') tensor(0.5890)
error: tensor(0.2063)
tensor(366.2851)
Epoch number :  2
-- "train" loss 0.0311 -- "valid" loss 366.3
training epoch: 3
step: 0 train loss: 0.015359578 0.018772252
step: 50 train loss: 0.018230632 0.018768646
step: 100 train loss: 0.018781986 0.018770475
step: 150 train loss: 0.019125605 0.018757537
step: 200 train loss: 0.017361723 0.01875522
step: 250 train loss: 0.02459812 0.018753313
step: 300 train loss: 0.027533289 0.01874731
step: 350 train loss: 0.02148612 0.018740302
step: 400 train loss: 0.018264515 0.018731384
step: 450 train loss: 0.025307056 0.018714333
step: 500 train loss: 0.012423309 0.01870924
step: 550 train loss: 0.013136565 0.018704684
step: 600 train loss: 0.014228971 0.01869848
step: 650 train loss: 0.01751459 0.018697828
step: 700 train loss: 0.017768884 0.018690662
step: 750 train loss: 0.014066445 0.018682264
step: 800 train loss: 0.020566856 0.018670073
step: 850 train loss: 0.017453955 0.01867326
step: 900 train loss: 0.014823889 0.018673714
step: 950 train loss: 0.033884306 0.018668262
step: 1000 train loss: 0.018839914 0.018672725
step: 1050 train loss: 0.0154298935 0.018670483
step: 1100 train loss: 0.01413015 0.018668044
step: 1150 train loss: 0.019611426 0.018661411
step: 1200 train loss: 0.028161714 0.018654058
step: 1250 train loss: 0.01364284 0.018649777
step: 1300 train loss: 0.017995797 0.018647915
step: 1350 train loss: 0.022886941 0.018642584
step: 1400 train loss: 0.01725178 0.01862954
step: 1450 train loss: 0.010237539 0.0186233
step: 1500 train loss: 0.019180877 0.01861944
step: 1550 train loss: 0.015334968 0.018616293
step: 1600 train loss: 0.016691586 0.01861141
step: 1650 train loss: 0.015762595 0.018603805
step: 1700 train loss: 0.012840946 0.018602416
step: 1750 train loss: 0.014925079 0.018599356
step: 1800 train loss: 0.01180698 0.0185933
step: 1850 train loss: 0.01545468 0.018586231
step: 1900 train loss: 0.014408374 0.018574005
step: 1950 train loss: 0.012025237 0.018570848
step: 2000 train loss: 0.024132326 0.01856685
step: 2050 train loss: 0.01781453 0.018564615
step: 2100 train loss: 0.018492686 0.01856136
step: 2150 train loss: 0.020229567 0.018556593
step: 2200 train loss: 0.017646592 0.018551474
step: 2250 train loss: 0.014587538 0.018550657
step: 2300 train loss: 0.018317997 0.01854724
step: 2350 train loss: 0.015773416 0.018551795
step: 2400 train loss: 0.018413305 0.018540846
step: 2450 train loss: 0.017242884 0.01853697
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6120]], device='cuda:0') tensor(0.5447)
tensor([[0.6223]], device='cuda:0') tensor(0.8603)
tensor([[0.6693]], device='cuda:0') tensor(0.5890)
error: tensor(0.2189)
tensor(389.7455)
Epoch number :  3
-- "train" loss 0.01422 -- "valid" loss 389.7
training epoch: 4
step: 0 train loss: 0.0146208815 0.018533587
step: 50 train loss: 0.01618998 0.01852394
step: 100 train loss: 0.020404099 0.018528653
step: 150 train loss: 0.021420456 0.018524561
step: 200 train loss: 0.017213443 0.018527247
step: 250 train loss: 0.017595498 0.018520573
step: 300 train loss: 0.015129758 0.018511742
step: 350 train loss: 0.016934786 0.018513873
step: 400 train loss: 0.015371649 0.018516947
step: 450 train loss: 0.01829117 0.0185064
step: 500 train loss: 0.011926419 0.018503828
step: 550 train loss: 0.018178847 0.018500458
step: 600 train loss: 0.02035345 0.018499985
step: 650 train loss: 0.021695158 0.018498791
step: 700 train loss: 0.025068277 0.018497718
step: 750 train loss: 0.014738092 0.018495314
step: 800 train loss: 0.021018425 0.018489238
step: 850 train loss: 0.012852585 0.01848716
step: 900 train loss: 0.021315059 0.018481417
step: 950 train loss: 0.019209566 0.01847927
step: 1000 train loss: 0.023069667 0.018478027
step: 1050 train loss: 0.015504699 0.018475756
step: 1100 train loss: 0.022038545 0.01847162
step: 1150 train loss: 0.017306408 0.018467192
step: 1200 train loss: 0.019661088 0.01846181
step: 1250 train loss: 0.019029826 0.018458828
step: 1300 train loss: 0.016929606 0.018454378
step: 1350 train loss: 0.01290485 0.018447168
step: 1400 train loss: 0.018294837 0.018442506
step: 1450 train loss: 0.018949645 0.018442668
step: 1500 train loss: 0.018667042 0.018441407
step: 1550 train loss: 0.012433784 0.01843828
step: 1600 train loss: 0.019852646 0.01843563
step: 1650 train loss: 0.020631323 0.01843404
step: 1700 train loss: 0.015283528 0.018426497
step: 1750 train loss: 0.025422394 0.018427458
step: 1800 train loss: 0.015028317 0.018423086
step: 1850 train loss: 0.0081467945 0.01841751
step: 1900 train loss: 0.013470598 0.01841455
step: 1950 train loss: 0.017458692 0.018412303
step: 2000 train loss: 0.011139571 0.018404048
step: 2050 train loss: 0.02170186 0.018400786
step: 2100 train loss: 0.019125562 0.018397324
step: 2150 train loss: 0.023916844 0.018390363
step: 2200 train loss: 0.021141542 0.018388612
step: 2250 train loss: 0.022215683 0.018394051
step: 2300 train loss: 0.024403341 0.018393243
step: 2350 train loss: 0.014041356 0.018386824
step: 2400 train loss: 0.019358756 0.018383827
step: 2450 train loss: 0.0155922035 0.01838574
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6801]], device='cuda:0') tensor(0.5447)
tensor([[0.6064]], device='cuda:0') tensor(0.8603)
tensor([[0.6223]], device='cuda:0') tensor(0.5890)
error: tensor(0.2155)
tensor(382.7732)
Epoch number :  4
-- "train" loss 0.01192 -- "valid" loss 382.8
training epoch: 5
step: 0 train loss: 0.02442145 0.018381774
step: 50 train loss: 0.02074387 0.01837711
step: 100 train loss: 0.016534768 0.018372953
step: 150 train loss: 0.031429052 0.018371655
step: 200 train loss: 0.026623327 0.018369555
step: 250 train loss: 0.022513878 0.018363537
step: 300 train loss: 0.0230514 0.018362163
step: 350 train loss: 0.011563881 0.018355016
step: 400 train loss: 0.010477024 0.018353835
step: 450 train loss: 0.022890069 0.018352231
step: 500 train loss: 0.023204576 0.018349102
step: 550 train loss: 0.019091818 0.018347558
step: 600 train loss: 0.011552674 0.018343832
step: 650 train loss: 0.013926653 0.018338274
step: 700 train loss: 0.0136157395 0.018335978
step: 750 train loss: 0.019098757 0.018332094
step: 800 train loss: 0.013821556 0.018330181
step: 850 train loss: 0.023331549 0.018328352
step: 900 train loss: 0.020071752 0.018325849
step: 950 train loss: 0.012454054 0.01832234
step: 1000 train loss: 0.0147326095 0.018313149
step: 1050 train loss: 0.021303 0.018309783
step: 1100 train loss: 0.015364755 0.018304573
step: 1150 train loss: 0.020889759 0.01829903
step: 1200 train loss: 0.020081472 0.018298287
step: 1250 train loss: 0.017229838 0.018300384
step: 1300 train loss: 0.024858937 0.018296333
step: 1350 train loss: 0.016148556 0.018294156
step: 1400 train loss: 0.012107696 0.018292064
step: 1450 train loss: 0.016688436 0.01828568
step: 1500 train loss: 0.0122006815 0.018278968
step: 1550 train loss: 0.019912772 0.018277802
step: 1600 train loss: 0.014284285 0.018278927
step: 1650 train loss: 0.012720547 0.018276505
step: 1700 train loss: 0.028021397 0.018277159
step: 1750 train loss: 0.01519696 0.018273672
step: 1800 train loss: 0.012482971 0.018271232
step: 1850 train loss: 0.021501081 0.01826853
step: 1900 train loss: 0.014142638 0.018264255
step: 1950 train loss: 0.022995422 0.018264532
step: 2000 train loss: 0.015519512 0.018260408
step: 2050 train loss: 0.018456126 0.018256374
step: 2100 train loss: 0.017179439 0.018252015
step: 2150 train loss: 0.016250804 0.018247746
step: 2200 train loss: 0.011213923 0.018247593
step: 2250 train loss: 0.024058437 0.018247556
step: 2300 train loss: 0.015607899 0.018242678
step: 2350 train loss: 0.013576716 0.018241568
step: 2400 train loss: 0.01172162 0.018236777
step: 2450 train loss: 0.013974852 0.018237464
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.5821]], device='cuda:0') tensor(0.5447)
tensor([[0.6066]], device='cuda:0') tensor(0.8603)
tensor([[0.6762]], device='cuda:0') tensor(0.5890)
error: tensor(0.2001)
tensor(359.1667)
Epoch number :  5
-- "train" loss 0.01643 -- "valid" loss 359.2
training epoch: 6
step: 0 train loss: 0.016220806 0.018237002
step: 50 train loss: 0.016363688 0.018232502
step: 100 train loss: 0.011377001 0.018229825
step: 150 train loss: 0.01427305 0.018226273
step: 200 train loss: 0.02182389 0.018223923
step: 250 train loss: 0.015315046 0.018218815
step: 300 train loss: 0.019484278 0.018215187
step: 350 train loss: 0.020562552 0.018214682
step: 400 train loss: 0.017080525 0.018211473
step: 450 train loss: 0.01806883 0.01820892
step: 500 train loss: 0.020236617 0.018207438
step: 550 train loss: 0.023249 0.018204935
step: 600 train loss: 0.017920306 0.018204778
step: 650 train loss: 0.013647657 0.018201623
step: 700 train loss: 0.01566818 0.018201275
step: 750 train loss: 0.021635488 0.01819758
step: 800 train loss: 0.014561507 0.01819789
step: 850 train loss: 0.014370954 0.018197102
step: 900 train loss: 0.01723063 0.01819508
step: 950 train loss: 0.01356976 0.018196158
step: 1000 train loss: 0.0182329 0.018192768
step: 1050 train loss: 0.013048142 0.018189829
step: 1100 train loss: 0.01648773 0.018188434
step: 1150 train loss: 0.015751448 0.018188851
step: 1200 train loss: 0.01882011 0.018186692
step: 1250 train loss: 0.025014771 0.01818202
step: 1300 train loss: 0.021682525 0.018181382
step: 1350 train loss: 0.01104144 0.018178094
step: 1400 train loss: 0.015032537 0.01817551
step: 1450 train loss: 0.018882101 0.018172901
step: 1500 train loss: 0.02080303 0.018172449
step: 1550 train loss: 0.026650377 0.018172303
step: 1600 train loss: 0.014993699 0.018170262
step: 1650 train loss: 0.01492797 0.018166145
step: 1700 train loss: 0.021893298 0.01816211
step: 1750 train loss: 0.016482353 0.01816272
step: 1800 train loss: 0.015500304 0.018159797
step: 1850 train loss: 0.02156558 0.01815869
step: 1900 train loss: 0.008470123 0.018155085
step: 1950 train loss: 0.019280186 0.018154105
step: 2000 train loss: 0.01866733 0.01814645
step: 2050 train loss: 0.024844686 0.018144371
step: 2100 train loss: 0.014049322 0.018139709
step: 2150 train loss: 0.012794475 0.018135672
step: 2200 train loss: 0.013403372 0.018135654
step: 2250 train loss: 0.019276518 0.018133273
step: 2300 train loss: 0.017750781 0.018131306
step: 2350 train loss: 0.011243655 0.018130064
step: 2400 train loss: 0.019134715 0.018128296
step: 2450 train loss: 0.013265887 0.018125968
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.5830]], device='cuda:0') tensor(0.5447)
tensor([[0.6216]], device='cuda:0') tensor(0.8603)
tensor([[0.6242]], device='cuda:0') tensor(0.5890)
error: tensor(0.2262)
tensor(386.4644)
Epoch number :  6
-- "train" loss 0.01011 -- "valid" loss 386.5
training epoch: 7
step: 0 train loss: 0.02357044 0.018126521
step: 50 train loss: 0.02016541 0.01812465
step: 100 train loss: 0.017600635 0.018120214
step: 150 train loss: 0.013880143 0.018116023
step: 200 train loss: 0.0155321285 0.018117514
step: 250 train loss: 0.01995538 0.018118234
step: 300 train loss: 0.022795377 0.018114872
step: 350 train loss: 0.008812572 0.018113662
step: 400 train loss: 0.015062613 0.018108258
step: 450 train loss: 0.010338613 0.018106848
step: 500 train loss: 0.016008819 0.018104663
step: 550 train loss: 0.020314315 0.018102892
step: 600 train loss: 0.0185046 0.018101517
step: 650 train loss: 0.0229032 0.018100528
step: 700 train loss: 0.026206356 0.018099308
step: 750 train loss: 0.012210718 0.018096397
step: 800 train loss: 0.013977175 0.018094882
step: 850 train loss: 0.023203675 0.018091565
step: 900 train loss: 0.026857432 0.0180925
step: 950 train loss: 0.016547628 0.018089639
step: 1000 train loss: 0.018770138 0.018088449
step: 1050 train loss: 0.012417679 0.01808408
step: 1100 train loss: 0.014845313 0.018081695
step: 1150 train loss: 0.016986476 0.018075088
step: 1200 train loss: 0.0218849 0.018072225
step: 1250 train loss: 0.019890618 0.01807083
step: 1300 train loss: 0.01911889 0.018071327
step: 1350 train loss: 0.018294634 0.018072976
step: 1400 train loss: 0.021497903 0.01807159
step: 1450 train loss: 0.015912872 0.018068608
step: 1500 train loss: 0.016335774 0.018068142
step: 1550 train loss: 0.014853041 0.018068995
step: 1600 train loss: 0.014132697 0.018068388
step: 1650 train loss: 0.016769174 0.018068632
step: 1700 train loss: 0.019611202 0.018065741
step: 1750 train loss: 0.018665452 0.018064663
step: 1800 train loss: 0.014246803 0.018065087
step: 1850 train loss: 0.0116594145 0.018065793
step: 1900 train loss: 0.020328622 0.018065967
step: 1950 train loss: 0.018433655 0.01806285
step: 2000 train loss: 0.017842066 0.018062916
step: 2050 train loss: 0.013967642 0.01806017
step: 2100 train loss: 0.014296262 0.018057423
step: 2150 train loss: 0.00748598 0.018055914
step: 2200 train loss: 0.017176474 0.018055687
step: 2250 train loss: 0.025411576 0.018053923
step: 2300 train loss: 0.016157486 0.018048266
step: 2350 train loss: 0.013077112 0.018046482
step: 2400 train loss: 0.017619725 0.018046334
step: 2450 train loss: 0.017310701 0.01804335
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.5552]], device='cuda:0') tensor(0.5447)
tensor([[0.6330]], device='cuda:0') tensor(0.8603)
tensor([[0.8139]], device='cuda:0') tensor(0.5890)
error: tensor(0.1922)
tensor(341.5410)
Epoch number :  7
-- "train" loss 0.02035 -- "valid" loss 341.5
training epoch: 8
step: 0 train loss: 0.018066268 0.018040458
step: 50 train loss: 0.013575907 0.01804082
step: 100 train loss: 0.021871695 0.01803656
step: 150 train loss: 0.014708119 0.018034868
step: 200 train loss: 0.019534504 0.01803649
step: 250 train loss: 0.014940291 0.018035432
step: 300 train loss: 0.016026853 0.018033387
step: 350 train loss: 0.011798961 0.018032316
step: 400 train loss: 0.021688592 0.018030312
step: 450 train loss: 0.017779082 0.018028947
step: 500 train loss: 0.036500983 0.018029217
step: 550 train loss: 0.020612447 0.01802692
step: 600 train loss: 0.02543224 0.018022513
step: 650 train loss: 0.013862924 0.018022353
step: 700 train loss: 0.019533824 0.018020216
step: 750 train loss: 0.012925722 0.018017888
step: 800 train loss: 0.017820036 0.018014867
step: 850 train loss: 0.018597202 0.01801332
step: 900 train loss: 0.022080671 0.018012144
step: 950 train loss: 0.018813154 0.018013164
step: 1000 train loss: 0.014837474 0.018010454
step: 1050 train loss: 0.017757706 0.018008836
step: 1100 train loss: 0.013138721 0.018008808
step: 1150 train loss: 0.023922814 0.018004723
step: 1200 train loss: 0.010763829 0.01800092
step: 1250 train loss: 0.014689094 0.018001128
step: 1300 train loss: 0.014404398 0.018000897
step: 1350 train loss: 0.0126958825 0.017999593
step: 1400 train loss: 0.017538667 0.01799899
step: 1450 train loss: 0.013730949 0.017994227
step: 1500 train loss: 0.018588979 0.017993286
step: 1550 train loss: 0.010583413 0.017991113
step: 1600 train loss: 0.012826104 0.017986918
step: 1650 train loss: 0.018650625 0.017984504
step: 1700 train loss: 0.025144845 0.017981399
step: 1750 train loss: 0.021133142 0.017985113
step: 1800 train loss: 0.022328364 0.017982263
step: 1850 train loss: 0.016636562 0.017981192
step: 1900 train loss: 0.018282915 0.01798154
step: 1950 train loss: 0.016586753 0.01798054
step: 2000 train loss: 0.022903247 0.017977832
step: 2050 train loss: 0.025429308 0.017976973
step: 2100 train loss: 0.018392451 0.01797529
step: 2150 train loss: 0.017717848 0.01797294
step: 2200 train loss: 0.012428677 0.017970137
step: 2250 train loss: 0.016775377 0.017966831
step: 2300 train loss: 0.007583574 0.017963639
step: 2350 train loss: 0.030576814 0.017965298
step: 2400 train loss: 0.016196245 0.017963998
step: 2450 train loss: 0.013134182 0.017963998
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.5665]], device='cuda:0') tensor(0.5447)
tensor([[0.6010]], device='cuda:0') tensor(0.8603)
tensor([[0.6612]], device='cuda:0') tensor(0.5890)
error: tensor(0.2080)
tensor(358.4345)
Epoch number :  8
-- "train" loss 0.007715 -- "valid" loss 358.4
training epoch: 9
step: 0 train loss: 0.01580914 0.017961143
step: 50 train loss: 0.011793821 0.017960552
step: 100 train loss: 0.01562588 0.017959174
step: 150 train loss: 0.016310086 0.017957114
step: 200 train loss: 0.013844132 0.017953457
step: 250 train loss: 0.014648875 0.017952396
step: 300 train loss: 0.013496895 0.017949961
step: 350 train loss: 0.020828184 0.017949224
step: 400 train loss: 0.010076923 0.01794817
step: 450 train loss: 0.01868013 0.017946543
step: 500 train loss: 0.012753584 0.017947087
step: 550 train loss: 0.0217188 0.01794464
step: 600 train loss: 0.009031682 0.017942091
step: 650 train loss: 0.0224608 0.017940069
step: 700 train loss: 0.013159056 0.01793785
step: 750 train loss: 0.011631896 0.017934255
step: 800 train loss: 0.020703007 0.01793233
step: 850 train loss: 0.0086824875 0.017931093
step: 900 train loss: 0.016615143 0.017929032
step: 950 train loss: 0.018340746 0.017928055
step: 1000 train loss: 0.020098398 0.017925872
step: 1050 train loss: 0.019682134 0.017923383
step: 1100 train loss: 0.017908936 0.01791991
step: 1150 train loss: 0.015055917 0.017915174
step: 1200 train loss: 0.013865817 0.017913053
step: 1250 train loss: 0.016729558 0.017912976
step: 1300 train loss: 0.02157847 0.017911663
step: 1350 train loss: 0.020105448 0.017911607
step: 1400 train loss: 0.018859657 0.017908482
step: 1450 train loss: 0.0086986525 0.017907612
step: 1500 train loss: 0.020663152 0.017906532
step: 1550 train loss: 0.016081681 0.01790351
step: 1600 train loss: 0.012400056 0.017901748
step: 1650 train loss: 0.021329079 0.017900296
step: 1700 train loss: 0.025827035 0.017898703
step: 1750 train loss: 0.014087717 0.017895706
step: 1800 train loss: 0.015234365 0.017894236
step: 1850 train loss: 0.017654777 0.01789597
step: 1900 train loss: 0.008765666 0.017895095
step: 1950 train loss: 0.02178863 0.017894415
step: 2000 train loss: 0.013424791 0.017892921
step: 2050 train loss: 0.017237503 0.017891508
step: 2100 train loss: 0.014499098 0.0178889
step: 2150 train loss: 0.016227558 0.01788754
step: 2200 train loss: 0.0100016715 0.01788357
step: 2250 train loss: 0.014725806 0.01788126
step: 2300 train loss: 0.0193654 0.01787979
step: 2350 train loss: 0.015150073 0.017879218
step: 2400 train loss: 0.01813874 0.017876782
step: 2450 train loss: 0.01346511 0.017872768
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6217]], device='cuda:0') tensor(0.5447)
tensor([[0.5943]], device='cuda:0') tensor(0.8603)
tensor([[0.6574]], device='cuda:0') tensor(0.5890)
error: tensor(0.2045)
tensor(349.8812)
Epoch number :  9
-- "train" loss 0.02557 -- "valid" loss 349.9
training epoch: 10
step: 0 train loss: 0.016218254 0.017873084
step: 50 train loss: 0.01554748 0.0178704
step: 100 train loss: 0.009553482 0.017869392
step: 150 train loss: 0.019814176 0.017868105
step: 200 train loss: 0.01726339 0.017867733
step: 250 train loss: 0.017630817 0.017866893
step: 300 train loss: 0.010633066 0.017869212
step: 350 train loss: 0.02033751 0.01786727
step: 400 train loss: 0.015973622 0.017866522
step: 450 train loss: 0.016440786 0.01786179
step: 500 train loss: 0.017359758 0.01786108
step: 550 train loss: 0.018813768 0.017862601
step: 600 train loss: 0.015339256 0.017856922
step: 650 train loss: 0.018250506 0.01785427
step: 700 train loss: 0.024009226 0.017853277
step: 750 train loss: 0.021322949 0.017851705
step: 800 train loss: 0.009751934 0.017849734
step: 850 train loss: 0.022227721 0.017849155
step: 900 train loss: 0.012411275 0.017845657
step: 950 train loss: 0.021434259 0.017845005
step: 1000 train loss: 0.012970245 0.017844148
step: 1050 train loss: 0.020934157 0.017840495
step: 1100 train loss: 0.016286891 0.0178391
step: 1150 train loss: 0.015465295 0.017837355
step: 1200 train loss: 0.019276872 0.017838167
step: 1250 train loss: 0.014240312 0.017836204
step: 1300 train loss: 0.011184513 0.017832153
step: 1350 train loss: 0.013555157 0.017830877
step: 1400 train loss: 0.021060795 0.017831722
step: 1450 train loss: 0.01469692 0.017828504
step: 1500 train loss: 0.013880507 0.017828664
step: 1550 train loss: 0.014872433 0.017826734
step: 1600 train loss: 0.011232346 0.017824814
step: 1650 train loss: 0.015480781 0.017824052
step: 1700 train loss: 0.013289816 0.017823081
step: 1750 train loss: 0.02018314 0.017820494
step: 1800 train loss: 0.009556658 0.017818639
step: 1850 train loss: 0.022001395 0.01781521
step: 1900 train loss: 0.020743795 0.017813087
step: 1950 train loss: 0.011534438 0.01781186
step: 2000 train loss: 0.008409588 0.017809642
step: 2050 train loss: 0.014142973 0.0178094
step: 2100 train loss: 0.013246731 0.017809315
step: 2150 train loss: 0.014799364 0.017807242
step: 2200 train loss: 0.015466552 0.01780589
step: 2250 train loss: 0.012175743 0.017805327
step: 2300 train loss: 0.020132048 0.017804055
step: 2350 train loss: 0.02049672 0.017802346
step: 2400 train loss: 0.026691778 0.017800601
step: 2450 train loss: 0.021295188 0.017798211
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6235]], device='cuda:0') tensor(0.5447)
tensor([[0.5804]], device='cuda:0') tensor(0.8603)
tensor([[0.6532]], device='cuda:0') tensor(0.5890)
error: tensor(0.1886)
tensor(325.9811)
Epoch number :  10
-- "train" loss 0.0145 -- "valid" loss 326.0
training epoch: 11
step: 0 train loss: 0.01476448 0.017795922
step: 50 train loss: 0.013636771 0.017796304
step: 100 train loss: 0.026194852 0.017794702
step: 150 train loss: 0.015425623 0.017792387
step: 200 train loss: 0.01314803 0.017792428
step: 250 train loss: 0.013490137 0.017790172
step: 300 train loss: 0.013521154 0.017788868
step: 350 train loss: 0.019913174 0.017788786
step: 400 train loss: 0.020723002 0.017786495
step: 450 train loss: 0.014188964 0.017783321
step: 500 train loss: 0.019393241 0.017782792
step: 550 train loss: 0.016574942 0.017780103
step: 600 train loss: 0.016599158 0.017779429
step: 650 train loss: 0.019371204 0.017779939
step: 700 train loss: 0.014920716 0.017781831
step: 750 train loss: 0.017628837 0.017783998
step: 800 train loss: 0.016569601 0.017783245
step: 850 train loss: 0.017525429 0.01778151
step: 900 train loss: 0.023177238 0.01778123
step: 950 train loss: 0.02509027 0.017782327

step: 1000 train loss: 0.017138714 0.017781386
step: 1050 train loss: 0.022863531 0.0177798
step: 1100 train loss: 0.011089255 0.017778305
step: 1150 train loss: 0.015652893 0.017775243
step: 1200 train loss: 0.019301495 0.017774083
step: 1250 train loss: 0.021948572 0.017773736
step: 1300 train loss: 0.009129338 0.017769467
step: 1350 train loss: 0.023328012 0.01776822
step: 1400 train loss: 0.013688996 0.01776902
step: 1450 train loss: 0.021111926 0.017767595
step: 1500 train loss: 0.009970281 0.017765002
step: 1550 train loss: 0.012952015 0.017764779
step: 1600 train loss: 0.016806483 0.017765284
step: 1650 train loss: 0.014632698 0.017764948
step: 1700 train loss: 0.018373158 0.017763386
step: 1750 train loss: 0.019635111 0.017762018
step: 1800 train loss: 0.017389152 0.017760357
step: 1850 train loss: 0.019492285 0.01775954
step: 1900 train loss: 0.013689535 0.017760983
step: 1950 train loss: 0.015094 0.017759657
step: 2000 train loss: 0.024619056 0.017757548
step: 2050 train loss: 0.013485024 0.01775597
step: 2100 train loss: 0.010527791 0.017752731
step: 2150 train loss: 0.0074465186 0.017751483
step: 2200 train loss: 0.012556705 0.017748035
step: 2250 train loss: 0.022670731 0.01774567
step: 2300 train loss: 0.011992024 0.017744187
step: 2350 train loss: 0.014722959 0.01774269
step: 2400 train loss: 0.011969255 0.017741513
step: 2450 train loss: 0.0132152075 0.017741675
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.5673]], device='cuda:0') tensor(0.5447)
tensor([[0.5562]], device='cuda:0') tensor(0.8603)
tensor([[0.7852]], device='cuda:0') tensor(0.5890)
error: tensor(0.2237)
tensor(402.4097)
Epoch number :  11
-- "train" loss 0.02508 -- "valid" loss 402.4
training epoch: 12
step: 0 train loss: 0.016421996 0.017741127
step: 50 train loss: 0.016849276 0.017741019
step: 100 train loss: 0.024776835 0.01773941
step: 150 train loss: 0.010655073 0.017736413
step: 200 train loss: 0.018163202 0.017734637
step: 250 train loss: 0.0253913 0.017734174
step: 300 train loss: 0.022128291 0.017732719
step: 350 train loss: 0.027916316 0.017731816
step: 400 train loss: 0.015304926 0.017730698
step: 450 train loss: 0.011487305 0.017729273
step: 500 train loss: 0.017485399 0.017729184
step: 550 train loss: 0.019804103 0.0177285
step: 600 train loss: 0.007078202 0.017725999
step: 650 train loss: 0.018330019 0.017725814
step: 700 train loss: 0.01453848 0.017723164
step: 750 train loss: 0.020943584 0.017722452
step: 800 train loss: 0.010559483 0.017720325
step: 850 train loss: 0.015284498 0.017718567
step: 900 train loss: 0.012320278 0.017717306
step: 950 train loss: 0.013484778 0.01771366
step: 1000 train loss: 0.017636219 0.017710922
step: 1050 train loss: 0.012142043 0.017710691
step: 1100 train loss: 0.015189701 0.017707882
step: 1150 train loss: 0.025979463 0.017706843
step: 1200 train loss: 0.023110729 0.01770789
step: 1250 train loss: 0.017149076 0.017705543
step: 1300 train loss: 0.019033497 0.017703617
step: 1350 train loss: 0.013329118 0.017703721
step: 1400 train loss: 0.01729561 0.017702611
step: 1450 train loss: 0.02049949 0.017700119
step: 1500 train loss: 0.01586787 0.01769836
step: 1550 train loss: 0.02096078 0.017696796
step: 1600 train loss: 0.016008466 0.01769568
step: 1650 train loss: 0.015801921 0.017694868
step: 1700 train loss: 0.014897328 0.017695066
step: 1750 train loss: 0.01617233 0.0176923
step: 1800 train loss: 0.016897896 0.017689578
step: 1850 train loss: 0.013123709 0.017689085
step: 1900 train loss: 0.01680241 0.017686794
step: 1950 train loss: 0.016735248 0.017685575
step: 2000 train loss: 0.024040623 0.01768445
step: 2050 train loss: 0.016236348 0.017682536
step: 2100 train loss: 0.017286133 0.017681735
step: 2150 train loss: 0.015875254 0.01768277
step: 2200 train loss: 0.0105281565 0.01767993
step: 2250 train loss: 0.015724916 0.017679373
step: 2300 train loss: 0.0076908018 0.01768029
step: 2350 train loss: 0.019441366 0.017679434
step: 2400 train loss: 0.012112527 0.017677017
step: 2450 train loss: 0.014832947 0.017675113
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.6252]], device='cuda:0') tensor(0.5447)
tensor([[0.5664]], device='cuda:0') tensor(0.8603)
tensor([[0.6619]], device='cuda:0') tensor(0.5890)
error: tensor(0.2015)
tensor(350.4141)
Epoch number :  12
-- "train" loss 0.02403 -- "valid" loss 350.4
training epoch: 13
step: 0 train loss: 0.017123118 0.017673703
step: 50 train loss: 0.016796935 0.017672842
step: 100 train loss: 0.018525694 0.0176735
step: 150 train loss: 0.017876107 0.017672537
step: 200 train loss: 0.01959892 0.017669957
step: 250 train loss: 0.01694781 0.017669357
step: 300 train loss: 0.010405784 0.017668013
step: 350 train loss: 0.01711452 0.01766713
step: 400 train loss: 0.013703434 0.017665677
step: 450 train loss: 0.01861231 0.01766308
step: 500 train loss: 0.023346381 0.017661696
step: 550 train loss: 0.012596613 0.017659528
step: 600 train loss: 0.024123657 0.017657392
step: 650 train loss: 0.017709052 0.017656263
step: 700 train loss: 0.021760639 0.017655948
step: 750 train loss: 0.025172886 0.017654479
step: 800 train loss: 0.02230956 0.017652981
step: 850 train loss: 0.017391026 0.017651359
step: 900 train loss: 0.011301252 0.017649945
step: 950 train loss: 0.020118292 0.017648071
step: 1000 train loss: 0.016050847 0.017647397
step: 1050 train loss: 0.022488456 0.017646203
step: 1100 train loss: 0.014671058 0.017644854
step: 1150 train loss: 0.01554423 0.017643811
step: 1200 train loss: 0.012411364 0.017644115
step: 1250 train loss: 0.014520941 0.01764341
step: 1300 train loss: 0.03319473 0.017642163
step: 1350 train loss: 0.024410974 0.01764219
step: 1400 train loss: 0.022878418 0.01764104
step: 1450 train loss: 0.018436994 0.01763897
step: 1500 train loss: 0.016375346 0.017637791
step: 1550 train loss: 0.01058764 0.0176355
step: 1600 train loss: 0.018644748 0.017633786
step: 1650 train loss: 0.016193803 0.017632976
step: 1700 train loss: 0.01756922 0.017630685
step: 1750 train loss: 0.019195309 0.01763077
step: 1800 train loss: 0.017810147 0.017629242
step: 1850 train loss: 0.015998611 0.017626122
step: 1900 train loss: 0.008321412 0.017624445
step: 1950 train loss: 0.015309263 0.017622862
step: 2000 train loss: 0.01753731 0.01762114
step: 2050 train loss: 0.016508 0.017620116
step: 2100 train loss: 0.013497674 0.017619886
step: 2150 train loss: 0.007861564 0.017619073
step: 2200 train loss: 0.011876795 0.01761734
step: 2250 train loss: 0.021345776 0.017615443
step: 2300 train loss: 0.017004672 0.017614266
step: 2350 train loss: 0.010973826 0.017613294
step: 2400 train loss: 0.016255284 0.017609868
step: 2450 train loss: 0.020173779 0.017608846
started to evaluate
ratio 0
ratio 1
ratio 2
ratio 3
tensor([[0.7412]], device='cuda:0') tensor(0.5447)
tensor([[0.5922]], device='cuda:0') tensor(0.8603)
tensor([[0.5445]], device='cuda:0') tensor(0.5890)
error: tensor(0.2430)
tensor(420.8840)
Epoch number :  13
-- "train" loss 0.02402 -- "valid" loss 420.9
training epoch: 14
step: 0 train loss: 0.011182033 0.017606223
step: 50 train loss: 0.018852886 0.017604603
step: 100 train loss: 0.011724703 0.01760471
step: 150 train loss: 0.013984577 0.017603343
step: 200 train loss: 0.014536332 0.017601723
step: 250 train loss: 0.016902598 0.017598318
step: 300 train loss: 0.012610988 0.017595876
step: 350 train loss: 0.021218032 0.017592795
step: 400 train loss: 0.016608901 0.017590595
step: 450 train loss: 0.019286167 0.017588964
step: 500 train loss: 0.019890081 0.017586712
step: 550 train loss: 0.020129267 0.017585093
step: 600 train loss: 0.01507789 0.017583083
step: 650 train loss: 0.01507506 0.017580807
step: 700 train loss: 0.019641625 0.017579148
Traceback (most recent call last):
  File "main.py", line 196, in <module>
    model, train_loss, valid_loss, total_loss = trainer.train(train_loader, valid_loader, relationmodel=relationmodel, encoder=encoder, wandb=wandb)
  File "D:\battery\utils.py", line 335, in train
    loss.backward()
  File "C:\Users\admin\anaconda3\envs\battery\lib\site-packages\torch\_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "C:\Users\admin\anaconda3\envs\battery\lib\site-packages\torch\autograd\__init__.py", line 197, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt